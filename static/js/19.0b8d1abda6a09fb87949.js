webpackJsonp([19],{M5d1:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s,r=i("mvHQ"),n=i.n(r),a={name:"divisionManage",components:{clickButtonAdd:function(){return i.e(24).then(i.bind(null,"z8Mq"))},clickButtonRevise:function(){return i.e(23).then(i.bind(null,"rPbI"))}},data:function(){return{curIndex:"0",tree:[],listLi:{},treeCenter:[],openList:[],defaultProps:{children:"child",label:"dptName"},carNumList:[],carId:"",leftSearchV:"",searchValueCenter:"",searchValueRight:"",wholeCarNumCenter:!1,wholeCarNumRight:!1,node:!1,centerWholeCheckedNum:0,centerCheckedTrueNum:0,rightWholeCheckedNum:0,rightCheckedTrueNum:0,dialogTableVisible:!1,formLabelWidth:"120px",title:"",curNode:{},addIsRevise:null,parentId:"00000000-0000-0000-0000-000000000000",rules:{},addDialog:{addDialog:!1},reviseDialog:{reviseDialog:!1}}},created:function(){},mounted:function(){},activated:function(){this.setCreated()},methods:{setCreated:function(){var e=this,t=this;i.e(22).then(i.bind(null,"sp+l")).then(function(i){s=new i.default.ParentFn,e.rules={dptName:[{validator:s.noIsEmpty("部门名称不能为空！"),required:!0,trigger:"blur"}],dptCode:[{validator:s.noIsEmpty("部门编码不能为空！"),required:!0,trigger:"blur"}]},s.error=e.$t("error"),s.success=e.$t("success"),s.button=e.$t("button"),s.message=e.$t("message"),s.divisionManage=e.$t("divisionManage"),t.listLi=s.divisionManage.leftTitle.listLi,s.ajax("api/services/app/SmDepartment/QueryAll",{id:t.parentId},t,function(e){if(e.success){var i=e.result.items;t.tree=s.setTreeChecked(i,"select"),console.log(t.tree),t.curNode=i[0],t.$nextTick(function(){t.$refs.leftTree.setCurrentKey(i[0].id)})}})});var r=[{text:"粤B12345"},{text:"粤B52135"},{text:"粤B86524"},{text:"粤B13645"},{text:"粤B54623"}];for(var n in r)r[n].checked=!1},clickAddInfo:function(){this.addDialog.addDialog=!0},addConfirm:function(e){var t=this;if(s.testTreeName(this.tree,this.listLi.dptName.model,this.curNode.id),s.boole)this.$message.error(s.error.nameRepeat);else{var i={};for(var r in e)i[r]=e[r].model;i.dptParentId=this.curNode.id,s.ajax("api/services/app/SmDepartment/Create",i,this,function(e){if(e.success){for(var r in t.$message({message:s.success.add,type:"success"}),t.addDialog.addDialog=!1,t.listLi)"dropDown"==t.listLi[r].type?t.listLi[r].model=0:t.listLi[r].model="";t.$refs.leftTree.append(e.result,i.dptParentId)}})}},addCancel:function(){this.addDialog.addDialog=!1},clickRevisedpt:function(){if(this.curNode.id!=this.parentId){for(var e in this.listLi)this.listLi[e].model=this.curNode[e];this.reviseDialog.reviseDialog=!0}else this.$message.error(s.error.menuRoot)},reviseConfirm:function(e){if(s.testReiveseTreeName(this.tree,this.listLi.dptName.model,this.curNode.id),s.boole)this.$message.error(s.error.nameRepeat);else{var t={},i=this;for(var r in e)t[r]=e[r].model;t.dptParentId=this.curNode.dptParentId,t.id=this.curNode.id,s.ajax("api/services/app/SmDepartment/Update",t,this,function(e){if(e.success){var r=JSON.parse(n()(i.tree));i.tree=s.reviseMenuTree(r,t.id,e.result),i.reviseDialog.reviseDialog=!1,i.curNode=e.result,i.$nextTick(function(){i.$refs.leftTree.setCurrentKey(e.result.id)}),i.$message({message:s.success.revise,type:"success"})}},"put")}},reviseCancel:function(){this.reviseDialog.reviseDialog=!1},clickDelete:function(){var e=this.curNode.id;if(this.parentId!=e){var t=this;s.nodeIsChild(this.tree,e),s.boole?this.$message.error(s.error.menuNode):this.$confirm(s.message.delete,s.message.title,{confirmButtonText:s.button.confirm,cancelButtonText:s.button.cancel,type:"warning"}).then(function(){s.ajax("api/services/app/SmDepartment/Delete?id="+e,"",t,function(i){i.success&&(t.$refs.leftTree.remove(e),t.$message({type:"success",message:s.success.delete}),t.curNode=t.tree[0],t.$refs.leftTree.setCurrentKey(t.curNode.id))},"DELETE")}).catch(function(){})}else this.$message.error(s.error.menuRoot)},leftSearch:function(){this.leftSearchV&&console.log(s.setTreeSelect(this.tree,"dptName","select",this.leftSearchV))},handleNodeClickFn:function(e){this.carId=e.id,this.curNode=e,this.node=!0},getPushChild:function(e,t){for(var i in e)void 0==e[i].children?t.push({text:e[i].text,id:e[i].id}):(t.push({text:e[i].text,id:e[i].id}),t[i].children=[],this.getPushChild(e[i].children,t[i].children));return t},getPushChildId:function(e,t,i){for(var s in e)e[s].id==t?e[s].node?this.getPushChildId(e[s].children,t,i):i.remove(e[s].id):this.getPushChildId(e[s].children,t,i)},getCurId:function(e,t,i){for(var s in e)e[s].id==t?(void 0==e[s].children&&(e[s].children=[]),e[s].children.push({text:i.text})):void 0!=e[s].children&&0!=e[s].children.length&&this.getCurId(e[s].children,t,i)},signNode:function(e,t){for(var i in t){if(t[i].id==e)return void(t[i].node=!0);void 0!=t[i].children&&t[i].children.length>0&&this.signNode(e,t[i].children)}},changeCenterChecked:function(e,t,i){for(var s=0;s<t.length;s++)t[s].id==e||"子级id"==e?(t[s].checked=i,void 0!=t[s].node&&void 0!=t[s].children&&t[s].children.length>0&&this.changeCenterChecked("子级id",t[s].children,i)):void 0!=t[s].node&&void 0!=t[s].children&&t[s].children.length>0&&this.changeCenterChecked(e,t[s].children,i)},getCheckedNum:function(e,t){for(var i in t)if(e==t[i].id||"全选"==e){if(void 0==t[i].node&&this.centerCheckedTrueNum++,"全选"!=e)return;void 0!=t[i].children&&t[i].children.length>0&&this.getCheckedNum(e,t[i].children)}else void 0!=t[i].children&&t[i].children.length>0&&this.getCheckedNum(e,t[i].children)},getCenterWholeNum:function(e){for(var t in e)e[t].node?void 0!=e[t].children&&e[t].children.length>0&&this.getCenterWholeNum(e[t].children):this.centerWholeCheckedNum++},clickMoveLeft:function(){if(this.node){var e=!1;for(var t in this.carNumList)this.carNumList[t].checked&&(e=!0);if(e)if(this.treeCenter.length>0)for(var t in this.carNumList)this.carNumList[t].checked&&(this.getCurId(this.treeCenter,this.carId,{text:this.carNumList[t].text}),this.openList=[],this.openList=this.openListPushId(this.treeCenter,this.openList));else this.$message({message:"请在左边树中选择部门！",type:"warning"});else this.$message({message:"请选择要添加的车辆！",type:"warning"})}else this.$message({message:"请在左边树中选择部门！",type:"warning"})},clickMoveRight:function(){if(this.treeCenter.length>0)if(this.centerCheckedTrueNum>0){var e=this.$refs.treeCenterDom.getCheckedKeys();for(var t in e)this.getPushChildId(this.treeCenter,e[t],this.$refs.treeCenterDom);this.centerCheckedTrueNum=0,this.centerWholeCheckedNum=0,this.getCenterWholeNum(this.treeCenter),this.wholeCarNumCenter=!1,this.$refs.treeCenterDom.setCheckedKeys([])}else this.$message({message:"请在中间树选择要撤销的车辆！",type:"warning"});else this.$message({message:"请在左边树中选择部门！",type:"warning"})},changeCheckedRightFn:function(e){for(var t in this.rightCheckedTrueNum=0,this.carNumList)this.carNumList[t].checked&&this.rightCheckedTrueNum++},wholeCarNumRightFn:function(){if(this.wholeCarNumRight)for(var e in this.carNumList)this.carNumList[e].checked=!0;else for(var e in this.carNumList)this.carNumList[e].checked=!1},handleNodeClickCenterFn:function(e,t){this.carId=e.id,e.node?this.node=e.node:this.node=!1},changeChecked:function(e,t){this.$refs.treeCenterDom.setCurrentKey("1");var i=this.$refs.treeCenterDom.getCheckedKeys();for(var s in this.centerCheckedTrueNum=0,i)this.getCheckedNum(i[s],this.treeCenter)},clickAddNode:function(){for(var e in this.dialogTableVisible=!0,this.title="添加部门",this.addIsRevise="1",this.listLi)this.listLi[e]=""},clickDeleteNode:function(){var e=this;""!=this.carId?this.$confirm("此操作将永久删除该部门, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(function(){e.$refs.leftTree.remove(e.carId),e.$message({type:"success",message:"删除成功!"})}).catch(function(){e.$message({type:"info",message:"已取消删除"})}):this.$message({type:"warning",message:"请选择要删除的部门！"})},clickReloadNode:function(){}},store:i("olkN").a,watch:{wholeCarNumCenter:function(){if(this.wholeCarNumCenter){var e=[];for(var t in this.tree)e.push(this.tree[t].id);this.$refs.treeCenterDom.setCheckedKeys(e),this.centerCheckedTrueNum=0,this.getCheckedNum("全选",this.treeCenter)}else this.$refs.treeCenterDom.setCheckedKeys([]),this.centerCheckedTrueNum=0},wholeCarNumRight:function(){if(this.rightCheckedTrueNum=0,this.wholeCarNumRight)for(var e in this.carNumList)this.carNumList[e].checked&&this.rightCheckedTrueNum++},centerCheckedTrueNum:function(){this.centerCheckedTrueNum==this.centerWholeCheckedNum?this.wholeCarNumCenter=!0:this.wholeCarNumCenter=!1}}},c={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-container",{staticStyle:{padding:"10px",background:"#fff",flex:"1",display:"flex","flex-direction":"column"}},[i("el-header",{staticClass:"current",attrs:{height:"32"}},[i("h5",{staticClass:"cur-title"},[e._v("部门车辆管理")])]),e._v(" "),i("el-container",{staticStyle:{padding:"0",background:"#fff",flex:"1",display:"flex"}},[i("el-main",{staticStyle:{flex:"1",padding:"0",display:"flex"}},[i("div",{staticClass:"left-box"},[i("div",{staticClass:"title"},[e._v("部门架构")]),e._v(" "),i("div",{staticClass:"left-content"},[i("div",{staticClass:"type-bar"},[i("click-button-add",{staticClass:"button margin-top floatLeft",attrs:{listLi:e.listLi,title:e.$t("divisionManage.leftTitle.addTitle"),rules:e.rules,formLabelWidth:e.formLabelWidth,addDialog:e.addDialog},on:{addConfirm:e.addConfirm,addInfoCancel:e.addCancel,clickAddInfo:e.clickAddInfo}}),e._v(" "),i("click-button-revise",{staticClass:"button margin-top floatLeft",attrs:{formLabelWidth:e.formLabelWidth,listLi:e.listLi,title:e.$t("menuManage.reviseTitle"),rules:e.rules,info:e.curNode,reviseDialog:e.reviseDialog,menuParentId:e.parentId},on:{reviseInfoCancel:e.reviseCancel,reviseConfirm:e.reviseConfirm,clickReviseInfo:e.clickRevisedpt}}),e._v(" "),i("el-button",{staticClass:"button margin-top floatLeft",attrs:{type:"primary",size:"small",icon:"el-icon-close"},on:{click:e.clickDelete}},[e._v(e._s(e.$t("button.delete")))]),e._v(" "),i("span",{staticClass:"el-icon-refresh",on:{click:e.clickReloadNode}}),e._v(" "),i("div",{staticClass:"search-bar"},[i("el-input",{staticClass:"search-input",attrs:{size:"small"},model:{value:e.leftSearchV,callback:function(t){e.leftSearchV=t},expression:"leftSearchV"}},[i("i",{staticClass:"el-input__icon search el-icon-search",attrs:{slot:"suffix"},on:{click:e.leftSearch},slot:"suffix"})])],1)],1),e._v(" "),i("el-aside",{staticStyle:{flex:"1"},attrs:{width:"100%"}},[i("el-tree",{ref:"leftTree",staticClass:"border-blue",attrs:{"expand-on-click-node":!1,"empty-text":"","default-expand-all":"",data:e.tree,"node-key":"id","highlight-current":"",props:e.defaultProps},on:{"node-click":e.handleNodeClickFn},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.node,r=t.data;return i("span",{staticClass:"custom-tree-node"},[void 0==r.child||0==r.child.length?i("span",{staticClass:"icon iconfont",staticStyle:{color:"#00a8d4","font-size":"14px"}},[e._v("")]):e._e(),e._v(" "),void 0!=r.child&&0!=r.child.length?i("span",{staticClass:"icon iconfont",staticStyle:{color:"#00a8d4","font-size":"12px"}},[e._v("")]):e._e(),e._v(" "),"node"!=r.type||r.opend?e._e():i("span",{staticClass:"icon iconfont",staticStyle:{color:"#00a8d4","font-size":"14px"}},[e._v("")]),e._v(" "),i("span",{class:s.select?"active":"",staticStyle:{"font-size":"14px"}},[e._v(e._s(s.label))])])}}])})],1)],1)]),e._v(" "),i("div",{staticClass:"center-box"},[i("div",{staticClass:"title"},[e._v("已分配")]),e._v(" "),i("div",{staticClass:"center-content"},[i("div",{staticClass:"type-bar"},[i("el-checkbox",{staticClass:"left",model:{value:e.wholeCarNumCenter,callback:function(t){e.wholeCarNumCenter=t},expression:"wholeCarNumCenter"}},[e._v("全选")]),e._v(" "),i("div",{staticClass:"left"},[e._v("已选择："+e._s(e.centerCheckedTrueNum))]),e._v(" "),i("div",{staticClass:"search-bar"},[i("el-input",{staticClass:"search-input",attrs:{size:"small"},model:{value:e.searchValueCenter,callback:function(t){e.searchValueCenter=t},expression:"searchValueCenter"}},[i("i",{staticClass:"el-input__icon search el-icon-search",attrs:{slot:"suffix"},slot:"suffix"})])],1)],1),e._v(" "),i("el-aside",{staticStyle:{flex:"1"},attrs:{width:"100%"}},[i("el-tree",{ref:"treeCenterDom",attrs:{"expand-on-click-node":!1,"empty-text":"",data:e.treeCenter,"show-checkbox":"","node-key":"id","highlight-current":"","default-expand-all":"",props:e.defaultProps},on:{check:e.changeChecked,"node-click":e.handleNodeClickCenterFn}})],1)],1)]),e._v(" "),i("div",{staticClass:"move-info"},[i("div",{staticClass:"move-btn"},[i("span",{staticClass:"el-icon-d-arrow-left",on:{click:e.clickMoveLeft}}),e._v(" "),i("span",{staticClass:"el-icon-d-arrow-right",on:{click:e.clickMoveRight}})])]),e._v(" "),i("div",{staticClass:"right-box"},[i("h6",{staticClass:"title"},[e._v("未分配")]),e._v(" "),i("div",{staticClass:"right-content"},[i("div",{staticClass:"type-bar"},[i("el-checkbox",{staticClass:"left",on:{change:e.wholeCarNumRightFn},model:{value:e.wholeCarNumRight,callback:function(t){e.wholeCarNumRight=t},expression:"wholeCarNumRight"}},[e._v("全选")]),e._v(" "),i("div",{staticClass:"left"},[e._v("已选择："+e._s(e.rightCheckedTrueNum))]),e._v(" "),i("div",{staticClass:"search-bar"},[i("el-input",{staticClass:"search-input",attrs:{size:"small"},model:{value:e.searchValueRight,callback:function(t){e.searchValueRight=t},expression:"searchValueRight"}},[i("i",{staticClass:"el-input__icon search el-icon-search",attrs:{slot:"suffix"},slot:"suffix"})])],1)],1),e._v(" "),i("el-aside",{staticStyle:{flex:"1",padding:"10px 20px 0"},attrs:{width:"100%"}},e._l(e.carNumList,function(t,s){return i("div",[i("el-checkbox",{on:{change:function(t){e.changeCheckedRightFn(s)}},model:{value:t.checked,callback:function(i){e.$set(t,"checked",i)},expression:"item.checked"}},[e._v(e._s(t.text))])],1)}))],1)])])],1)],1)},staticRenderFns:[]};var l=i("VU/8")(a,c,!1,function(e){i("fH95")},"data-v-2063dd82",null);t.default=l.exports},fH95:function(e,t){}});
//# sourceMappingURL=19.0b8d1abda6a09fb87949.js.map