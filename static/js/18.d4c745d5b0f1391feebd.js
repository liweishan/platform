webpackJsonp([18],{"8hAt":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,s=a("mvHQ"),l=a.n(s),n={components:{clickButtonAdd:function(){return a.e(24).then(a.bind(null,"z8Mq"))},clickButtonRevise:function(){return a.e(23).then(a.bind(null,"rPbI"))}},name:"buttonManage",data:function(){return{listLi:{},search:{},tableData:[],tableDataAll:[],total:0,tableH:0,addDialog:{addDialog:!1},reviseDialog:{reviseDialog:!1},formLabelWidth:"120px",rules:{},curNode:{}}},created:function(){},mounted:function(){var t=this.$refs.tableBox.offsetHeight,e=this.$refs.pagination.offsetHeight;this.tableH=t-e},activated:function(){this.getInfo()},methods:{getInfo:function(){var t=this,e=this;a.e(22).then(a.bind(null,"sp+l")).then(function(a){(i=new a.default.ParentFn).error=t.$t("error"),i.success=t.$t("success"),i.button=t.$t("button"),i.message=t.$t("message"),i.buttonManage=t.$t("buttonManage"),t.listLi=i.buttonManage.listLi,t.rules={oprCode:[{validator:i.noIsEmpty(i.buttonManage.operationRules.oprCode),required:!0,trigger:"blur"}],oprName:[{validator:i.noIsEmpty(i.buttonManage.operationRules.oprName),required:!0,trigger:"blur"}],oprType:[{validator:i.noIsEmpty(i.buttonManage.operationRules.oprType),required:!0,trigger:"blur"}]},i.ajax("api/services/app/SmOperation/QueryAll","",e,function(t){if(t.success){var a=t.result.items;for(var i in a)a[i].checked=!1;e.tableData=a,e.tableDataAll=JSON.parse(l()(a)),e.total=a.length}})})},changeCurPage:function(t){},clickAddInfo:function(){this.addDialog.addDialog=!0},addConfirm:function(t){var e={},a=this;for(var s in t)e[s]=t[s].model;i.ajax("api/services/app/SmOperation/Create",e,a,function(t){t.success&&(a.tableDataAll.push(t.result),a.search.buttonName||a.search.id?a.query():a.tableData.push(t.result),a.addDialog.addDialog=!1,a.total=a.tableData.length,a.$message({type:"success",message:i.success.add}))})},addInfoCancel:function(){this.addDialog.addDialog=!1},reviseInfo:function(){var t=0;for(var e in this.tableData)this.tableData[e].checked&&(this.curNode=this.tableData[e],this.tableData[e].id,t++);if(1==t){for(var a in this.listLi)this.listLi[a].model=this.curNode[a];this.reviseDialog.reviseDialog=!0}else this.$message.error(i.error.noData)},reviseConfirm:function(t){var e={},a=this;for(var s in t)e[s]=t[s].model;e.id=this.curNode.id,i.ajax("api/services/app/SmOperation/Update",e,a,function(t){if(t.success){for(var e in a.tableData)a.tableData[e].id==a.curNode.id&&a.tableData.splice(e,1,t.result);for(var e in a.tableDataAll)a.curNode.id==a.tableDataAll[e].id&&a.tableDataAll.splice(e,1,t.result);for(var s in a.curNode=t.result,a.reviseDialog.reviseDialog=!1,a.listLi)"dropDown"==a.listLi[s].type?a.listLi[s].model=0:a.listLi[s].model="";a.$message({message:i.success.revise,type:"success"})}},"PUT")},reviseCancel:function(){this.reviseDialog.reviseDialog=!1},select:function(t,e){for(var a in this.curNode=e,this.tableData)if(this.tableData[a].id==e.id){this.tableData[a].checked=!this.tableData[a].checked,this.tableData[a].checked?this.$refs.table.setCurrentRow(e):this.$refs.table.setCurrentRow();break}},selectAll:function(t){if(this.$refs.table.setCurrentRow(),t.length>0)for(var e in this.tableData)this.tableData[e].checked=!0;else for(var e in this.tableData)this.tableData[e].checked=!1},rowClick:function(t,e,a){for(var i in this.tableData)if(this.tableData[i].id==t.id){this.tableData[i].checked=!this.tableData[i].checked,this.$refs.table.toggleRowSelection(t,this.tableData[i].checked),this.tableData[i].checked?this.$refs.table.setCurrentRow(t):this.$refs.table.setCurrentRow();break}},clickDelete:function(){var t=this,e=this,a=[];for(var s in this.tableData)this.tableData[s].checked&&a.push(this.tableData[s].id);a.length>0?this.$confirm(i.message.delete,i.message.title,{confirmButtonText:i.button.confirm,cancelButtonText:i.button.cancel,type:"warning"}).then(function(){i.ajax("api/services/app/SmOperation/DeleteMore?input="+a.join(","),"",t,function(t){if(t.success){for(var s=0;s<a.length;s++){for(var l=0;l<e.tableDataAll.length;l++)a[s]==e.tableDataAll[l].id&&(e.tableDataAll.splice(l,1),l--);for(l=0;l<e.tableData.length;l++)a[s]==e.tableData[l].id&&(e.tableData.splice(l,1),l--)}e.curNode={},e.total=e.tableData.length,e.$message({type:"success",message:i.success.delete})}},"DELETE")}).catch(function(){}):this.$message.error(i.error.noData)},query:function(){var t=this.search.buttonName,e=this.search.id;if(t||e){this.tableData=JSON.parse(l()(this.tableDataAll));for(var a=0;a<this.tableData.length;a++)t&&e?-1!=this.tableData[a].oprCode.indexOf(e)&&-1!=this.tableData[a].oprName.indexOf(t)||(this.tableData.splice(a,1),a--):t&&!e?-1==this.tableData[a].oprName.indexOf(t)&&(this.tableData.splice(a,1),a--):!t&&e&&(console.log(this.tableData[a].oprCode.indexOf(e)),-1==this.tableData[a].oprCode.indexOf(e)&&(this.tableData.splice(a,1),a--))}else this.tableData=JSON.parse(l()(this.tableDataAll))}},store:a("olkN").a,watch:{}},r={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("el-row",{staticClass:"row"},[a("click-button-add",{staticClass:"button",attrs:{listLi:t.listLi,title:t.$t("buttonManage.addTitle"),rules:t.rules,formLabelWidth:t.formLabelWidth,addDialog:t.addDialog},on:{addConfirm:t.addConfirm,addInfoCancel:t.addInfoCancel,clickAddInfo:t.clickAddInfo}}),t._v(" "),a("click-button-revise",{staticClass:"button",attrs:{formLabelWidth:t.formLabelWidth,listLi:t.listLi,title:t.$t("buttonManage.reviseTitle"),rules:t.rules,info:t.curNode,reviseDialog:t.reviseDialog},on:{reviseInfoCancel:t.reviseCancel,reviseConfirm:t.reviseConfirm,clickReviseInfo:t.reviseInfo}}),t._v(" "),a("el-button",{staticClass:"button",attrs:{type:"primary",size:"small",icon:"el-icon-close"},on:{click:t.clickDelete}},[t._v(t._s(t.$t("button.delete")))]),t._v(" "),a("el-row",{staticClass:"model-input"},[a("span",{staticClass:"name"},[t._v("按钮名称：")]),t._v(" "),a("el-input",{staticClass:"input",attrs:{size:"small"},model:{value:t.search.buttonName,callback:function(e){t.$set(t.search,"buttonName",e)},expression:"search.buttonName"}})],1),t._v(" "),a("el-row",{staticClass:"model-input"},[a("span",{staticClass:"name"},[t._v("权限标识：")]),t._v(" "),a("el-input",{staticClass:"input",attrs:{size:"small"},model:{value:t.search.id,callback:function(e){t.$set(t.search,"id",e)},expression:"search.id"}})],1),t._v(" "),a("el-button",{staticClass:"button",attrs:{type:"primary",size:"small",icon:"el-icon-search"},on:{click:t.query}},[t._v(t._s(t.$t("button.search")))])],1),t._v(" "),a("div",{ref:"tableBox",staticClass:"table-box"},[a("el-table",{ref:"table",staticClass:"center",staticStyle:{"text-align":"center",width:"100%"},attrs:{data:t.tableData,height:t.tableH,size:"mini"},on:{select:t.select,"select-all":t.selectAll,"row-click":t.rowClick}},[a("el-table-column",{attrs:{width:"100",type:"selection",height:"40px"}}),t._v(" "),t._l(t.$t("buttonManage.tableTitle"),function(t,e){return a("el-table-column",{key:e,attrs:{prop:t.prop,width:t.width,label:t.label}})})],2),t._v(" "),a("div",{ref:"pagination",staticClass:"block"},[a("el-pagination",{staticClass:"pagination",attrs:{"page-size":20,layout:"prev, pager, next",total:t.total},on:{"current-change":t.changeCurPage}})],1)],1)],1)},staticRenderFns:[]};var o=a("VU/8")(n,r,!1,function(t){a("H0NX")},"data-v-3401d382",null);e.default=o.exports},H0NX:function(t,e){}});
//# sourceMappingURL=18.d4c745d5b0f1391feebd.js.map